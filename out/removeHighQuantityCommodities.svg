<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                width="668" height="904">
                
            <g>
                <rect x="50" y="80"
            width="408.8" height="30"
            style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                    
                <line x1="60" y1="80" x2="60" y2="110"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                <line x1="448.8" y1="80" x2="448.8" y2="110"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
             
                <title>function removeHighQuantityCommodities(remove)</title>
            <text x="75" y="100"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="75" y="100">function removeHighQuantityCommodities(remove)</tspan>
            </text>
                
            </g>
            <g>
                <rect x="87" y="128.5"
            width="443.4" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                
                <line x1="530.4" y1="138.5" x2="535.4" y2="138.5"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                
                <line x1="530.4" y1="148.5" x2="535.4" y2="148.5"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />

                <path d="M535.4, 132.5 L551.4, 143.5 L535.4, 154.5 Z" 
        fill="#a5d6a7" stroke="#444" stroke-width="1" />
                             
                <title>return getAssetRegistry(&apos;org.acme.trading.Commodity&apos;).then(function (assetRegistry) {
  return query(&apos;selectCommoditiesWithHighQuantity&apos;).then(function (results) {
    var promises = [];

    for (var n = 0; n &lt; results.length; n++) {
      var trade = results[n]; // emit a notification that a trade was removed

      var removeNotification = getFactory().newEvent(&apos;org.acme.trading&apos;, &apos;RemoveNotification&apos;);
      removeNotification.commodity = trade;
      emit(removeNotification); // remove the commodity

      promises.push(assetRegistry.remove(trade));
    } // we have to return all the promises


    return Promise.all(promises);
  });
})</title>
            <text x="102" y="148.5"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="102" y="148.5">return getAssetRegistry(&apos;org.acme.trading.Commodit...</tspan>
            </text>
                
            </g>
                <g>
                   <rect x="124" y="177"
            width="388.8" height="30"
            rx="2" ry="2"
            style="fill:#C5E1A5; stroke:#444; stroke-width:1" />
                   <title>getAssetRegistry(&apos;org.acme.trading.Commodity&apos;)</title>
            <text x="139" y="197"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="139" y="197">getAssetRegistry(&apos;org.acme.trading.Commodity&apos;)</tspan>
            </text>
                   
                   
                </g>
            <g>
                <rect x="124" y="225.5"
            width="229.4" height="30"
            style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                    
                <line x1="134" y1="225.5" x2="134" y2="255.5"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                <line x1="343.4" y1="225.5" x2="343.4" y2="255.5"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
             
                <title>function(assetRegistry)</title>
            <text x="149" y="245.5"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="149" y="245.5">function(assetRegistry)</tspan>
            </text>
                
            </g>
            <g>
                <rect x="161" y="274"
            width="443.4" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                
                <line x1="604.4" y1="284" x2="609.4" y2="284"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                
                <line x1="604.4" y1="294" x2="609.4" y2="294"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />

                <path d="M609.4, 278 L625.4, 289 L609.4, 300 Z" 
        fill="#a5d6a7" stroke="#444" stroke-width="1" />
                             
                <title>return query(&apos;selectCommoditiesWithHighQuantity&apos;).then(function (results) {
  var promises = [];

  for (var n = 0; n &lt; results.length; n++) {
    var trade = results[n]; // emit a notification that a trade was removed

    var removeNotification = getFactory().newEvent(&apos;org.acme.trading&apos;, &apos;RemoveNotification&apos;);
    removeNotification.commodity = trade;
    emit(removeNotification); // remove the commodity

    promises.push(assetRegistry.remove(trade));
  } // we have to return all the promises


  return Promise.all(promises);
})</title>
            <text x="176" y="294"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="176" y="294">return query(&apos;selectCommoditiesWithHighQuantity&apos;)....</tspan>
            </text>
                
            </g>
                <g>
                   <rect x="198" y="322.5"
            width="357.59999999999997" height="30"
            rx="2" ry="2"
            style="fill:#C5E1A5; stroke:#444; stroke-width:1" />
                   <title>query(&apos;selectCommoditiesWithHighQuantity&apos;)</title>
            <text x="213" y="342.5"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="213" y="342.5">query(&apos;selectCommoditiesWithHighQuantity&apos;)</tspan>
            </text>
                   
                   
                </g>
            <g>
                <rect x="198" y="371"
            width="182.6" height="30"
            style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                    
                <line x1="208" y1="371" x2="208" y2="401"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                <line x1="370.6" y1="371" x2="370.6" y2="401"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
             
                <title>function(results)</title>
            <text x="223" y="391"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="223" y="391">function(results)</tspan>
            </text>
                
            </g>
                <g>
                   <rect x="235" y="419.5"
            width="162.6" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                   <title>var promises = []</title>
            <text x="250" y="439.5"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="250" y="439.5">var promises = []</tspan>
            </text>
                   
                   
                </g><g>

            <rect x="265" y="503"
            width="200.4" height="30"
            rx="3" ry="3"
            style="fill:#b39ddb; stroke:#444; stroke-width:1" />
            <polygon points="235,518 265,488 295,518 265,548"
            style="fill:#b39ddb; stroke:#444; stroke-width:1" />
                
            <title>n &lt; results.length</title>
            <text x="310" y="523"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="310" y="523">n &lt; results.length</tspan>
            </text>
            
            <text x="253.3" y="523"
        font-family="monospace" font-size="13" fill="#222">for</text>
        </g>
                <g>
                   <rect x="285" y="558"
            width="53.4" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                   <title>n++</title>
            <text x="300" y="578"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="300" y="578">n++</tspan>
            </text>
                   
                   
                </g>
                <g>
                   <rect x="285" y="606.5"
            width="201.6" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                   <title>var trade = results[n]</title>
            <text x="300" y="626.5"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="300" y="626.5">var trade = results[n]</tspan>
            </text>
                   
                   
                </g>
                <g>
                   <rect x="285" y="655"
            width="342" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                   <title>var removeNotification = [object Object]</title>
            <text x="300" y="675"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="300" y="675">var removeNotification = [object Object]</tspan>
            </text>
                   
                   
                </g>
                <g>
                   <rect x="285" y="703.5"
            width="310.8" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                   <title>removeNotification.commodity = trade</title>
            <text x="300" y="723.5"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="300" y="723.5">removeNotification.commodity = trade</tspan>
            </text>
                   
                   
                </g>
                <g>
                   <rect x="285" y="752"
            width="217.2" height="30"
            rx="2" ry="2"
            style="fill:#C5E1A5; stroke:#444; stroke-width:1" />
                   <title>emit(removeNotification)</title>
            <text x="300" y="772"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="300" y="772">emit(removeNotification)</tspan>
            </text>
                   
                   
                </g>
                <g>
                   <rect x="285" y="800.5"
            width="357.59999999999997" height="30"
            rx="2" ry="2"
            style="fill:#C5E1A5; stroke:#444; stroke-width:1" />
                   <title>promises.push(assetRegistry.remove(trade))</title>
            <text x="300" y="820.5"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="300" y="820.5">promises.push(assetRegistry.remove(trade))</tspan>
            </text>
                   
                   
                </g>
            <g>
                <rect x="235" y="849"
            width="248.39999999999998" height="30"
            rx="3" ry="3"
            style="fill:#90caf9; stroke:#444; stroke-width:1" />
                
                <line x1="483.4" y1="859" x2="488.4" y2="859"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />
                
                <line x1="483.4" y1="869" x2="488.4" y2="869"
                style="fill:#a5d6a7; stroke:#444; stroke-width:1" />

                <path d="M488.4, 853 L504.4, 864 L488.4, 875 Z" 
        fill="#a5d6a7" stroke="#444" stroke-width="1" />
                             
                <title>return Promise.all(promises)</title>
            <text x="250" y="869"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="250" y="869">return Promise.all(promises)</tspan>
            </text>
                
            </g>
            <g>
               <rect x="25" y="13.75"
            width="216.6" height="24"
            style="fill:#fff59d; stroke:#444; stroke-width:1" />
               <circle cx="25" cy="25" r="15"
        style="fill:#fff59d; stroke:#444; stroke-width:1" />
               <title>Program: source module</title>
            <text x="55" y="30"
                font-family="monospace" font-size="13" fill="#222">
                <tspan x="55" y="30">Program: source module</tspan>
            </text>
            </g>
            <g>
               <path d="M25, 40 L25 91 Q25 95
                29 95
                L42 95 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M42, 92 L50, 95 L42, 98 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M68.5, 110 L68.5 139.5 Q68.5 143.5
                72.5 143.5
                L79 143.5 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M79, 140.5 L87, 143.5 L79, 146.5 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M105.5, 158.5 L105.5 188 Q105.5 192
                109.5 192
                L116 192 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M116, 189 L124, 192 L116, 195 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M105.5, 158.5 L105.5 236.5 Q105.5 240.5
                109.5 240.5
                L116 240.5 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M116, 237.5 L124, 240.5 L116, 243.5 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M142.5, 255.5 L142.5 285 Q142.5 289
                146.5 289
                L153 289 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M153, 286 L161, 289 L153, 292 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M179.5, 304 L179.5 333.5 Q179.5 337.5
                183.5 337.5
                L190 337.5 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M190, 334.5 L198, 337.5 L190, 340.5 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M179.5, 304 L179.5 382 Q179.5 386
                183.5 386
                L190 386 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M190, 383 L198, 386 L190, 389 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M216.5, 401 L216.5 430.5 Q216.5 434.5
                220.5 434.5
                L227 434.5 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M227, 431.5 L235, 434.5 L227, 437.5 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M216.5, 401 L216.5 514 Q216.5 518
                220.5 518
                L227 518 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M227, 515 L235, 518 L227, 521 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M265, 548 L265 569 Q265 573
                269 573
                L277 573 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M277, 570 L285, 573 L277, 576 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M265, 548 L265 617.5 Q265 621.5
                269 621.5
                L277 621.5 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M277, 618.5 L285, 621.5 L277, 624.5 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M265, 548 L265 666 Q265 670
                269 670
                L277 670 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M277, 667 L285, 670 L277, 673 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M265, 548 L265 714.5 Q265 718.5
                269 718.5
                L277 718.5 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M277, 715.5 L285, 718.5 L277, 721.5 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M265, 548 L265 763 Q265 767
                269 767
                L277 767 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M277, 764 L285, 767 L277, 770 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M265, 548 L265 811.5 Q265 815.5
                269 815.5
                L277 815.5 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M277, 812.5 L285, 815.5 L277, 818.5 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M642.5999999999999, 815.5 L658.5999999999999 815.5  Q662.5999999999999 815.5
                662.5999999999999 811.5
                L662.5999999999999 476 Q662.5999999999999 468
                658.5999999999999 468
                L273 468  Q265 468
                265 472
                L265 480"
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M262, 480 L265, 488 L268, 480 Z" 
        fill="#333" />
            </g>
            <g>
               <path d="M216.5, 401 L216.5 860 Q216.5 864
                220.5 864
                L227 864 "
        style="fill:none; stroke:#444; stroke-width:1" />
               <path d="M227, 861 L235, 864 L227, 867 Z" 
        fill="#333" />
            </g>
            </svg>
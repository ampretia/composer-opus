<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>metal-commodity-network</title>

    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/x-icon" href="/api-doc/composer/unstable/favicon.ico">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">


    <link href="./assets/css/normalize.css" rel="stylesheet">
    <link href="./assets/css/new-style.min.css" rel="stylesheet">
    <link href="./assets/css/grid-layout.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>

</head>


<body class="">

    <div class="SiteWrapper">
        <div class="content">
            <article class="docs-container">

                 <div class="page-sidebar-grid" id="off-canvas">
                
                    <div class="docs-pagenav-grid">
                        <!-- Navigation -->
                        <nav class="navbar-docs" role="navigation">
                            <!-- Brand and toggle get grouped for better mobile display -->
                            <a class="navbar-brand" href="/composer/unstable/index.html">
                                <b>metal-commodity-network</b></a>0.1.7
                            <!-- Collect the nav links, forms, and other content for toggling 
                            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                                <div class="top-nav-docs">
                                    <a href="../tutorials/tutorials.html">Tutorials</a>
                                    <a href="../introduction/introduction.html">Docs</a>
                                    <a href="../support/support-index.html">Community</a>
                                </div>
                            </div>-->
                        </nav>

                    </div>

                  <!--  <div class="docs-current-page-grid">
                        <p><a href="#summaries">Summaries</a></p>
                    </div>-->
                    
                    <nav class="context-nav">
                    <ul>
                        <li><p><a href="#readme"><b>ReadMe</b><img src="./assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
                     
                        <li><p><a href="#asset-definition-summaries"><b>Assets</b><img src="./assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
                                  <ul>
                                        
                                            <li><p><a href="#asset">Asset</a></p></li>
                                        
                                            <li><p><a href="#registry">Registry</a></p></li>
                                        
                                            <li><p><a href="#assetregistry">AssetRegistry</a></p></li>
                                        
                                            <li><p><a href="#participantregistry">ParticipantRegistry</a></p></li>
                                        
                                            <li><p><a href="#transactionregistry">TransactionRegistry</a></p></li>
                                        
                                            <li><p><a href="#network">Network</a></p></li>
                                        
                                            <li><p><a href="#historianrecord">HistorianRecord</a></p></li>
                                        
                                            <li><p><a href="#identity">Identity</a></p></li>
                                        
                                            <li><p><a href="#commodity">Commodity</a></p></li>
                                        
                                    </ul>
                                </ul>
                                <li><p><a href="#transaction-definition-summaries"><b>Transactions</b><img src="./assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
                                <ul>
                                   
                                        
                                            <li><p><a href="#transaction">Transaction</a></p></li>
                                        
                                            <li><p><a href="#registrytransaction">RegistryTransaction</a></p></li>
                                        
                                            <li><p><a href="#assettransaction">AssetTransaction</a></p></li>
                                        
                                            <li><p><a href="#participanttransaction">ParticipantTransaction</a></p></li>
                                        
                                            <li><p><a href="#addasset">AddAsset</a></p></li>
                                        
                                            <li><p><a href="#updateasset">UpdateAsset</a></p></li>
                                        
                                            <li><p><a href="#removeasset">RemoveAsset</a></p></li>
                                        
                                            <li><p><a href="#addparticipant">AddParticipant</a></p></li>
                                        
                                            <li><p><a href="#updateparticipant">UpdateParticipant</a></p></li>
                                        
                                            <li><p><a href="#removeparticipant">RemoveParticipant</a></p></li>
                                        
                                            <li><p><a href="#issueidentity">IssueIdentity</a></p></li>
                                        
                                            <li><p><a href="#bindidentity">BindIdentity</a></p></li>
                                        
                                            <li><p><a href="#activatecurrentidentity">ActivateCurrentIdentity</a></p></li>
                                        
                                            <li><p><a href="#revokeidentity">RevokeIdentity</a></p></li>
                                        
                                            <li><p><a href="#trade">Trade</a></p></li>
                                        
                                            <li><p><a href="#traderbyid">TraderById</a></p></li>
                                        
                                            <li><p><a href="#bulktrade">BulkTrade</a></p></li>
                                        
                                            <li><p><a href="#removehighquantitycommodities">RemoveHighQuantityCommodities</a></p></li>
                                        
                                            <li><p><a href="#_demosetup">_demoSetup</a></p></li>
                                        
                                    </ul>
                                
                        <li><p><a href="#detail"><b>Details</b><img src="./assets/img/Caret_SW_2.svg" class="caret"></a></p></li>
                    </ul>

                    </nav>

                </div>



                <div class="page-content-grid">
                    <section class="content-chunk" id="readme">
                    <h1 id="commodity-network">Commodity Network</h1>
<blockquote>
<p>This Business Network illustrates commodity trading.</p>
</blockquote>
<p>This business network defines:</p>
<p><strong>Participant</strong>
<code>Regulator</code></p>
<p><strong>Participant</strong>
<code>Trader</code></p>
<p><strong>Asset</strong>
<code>Commodity</code></p>
<p><strong>Transaction(s)</strong>
<code>Transaction</code></p>
<p><strong>Event</strong>
<code>TradeNotification</code></p>
<p>To test this Business Network Definition in the <strong>Test</strong> tab:</p>
<p>Create two <code>Trader</code> participants:</p>
<pre><code>{
  &quot;$class&quot;: &quot;org.acme.trading.Trader&quot;,
  &quot;tradeId&quot;: &quot;TRADER1&quot;,
  &quot;firstName&quot;: &quot;Jenny&quot;,
  &quot;lastName&quot;: &quot;Jones&quot;
}
</code></pre>
<pre><code>{
  &quot;$class&quot;: &quot;org.acme.trading.Trader&quot;,
  &quot;tradeId&quot;: &quot;TRADER2&quot;,
  &quot;firstName&quot;: &quot;Amy&quot;,
  &quot;lastName&quot;: &quot;Williams&quot;
}
</code></pre>
<p>Create a <code>Commodity</code> asset:</p>
<pre><code>{
  &quot;$class&quot;: &quot;org.acme.trading.Commodity&quot;,
  &quot;tradingSymbol&quot;: &quot;ABC&quot;,
  &quot;description&quot;: &quot;Test commodity&quot;,
  &quot;mainExchange&quot;: &quot;Euronext&quot;,
  &quot;quantity&quot;: 72.297,
  &quot;owner&quot;: &quot;resource:org.acme.trading.Trader#TRADER1&quot;
}
</code></pre>
<p>Submit a <code>Trade</code> transaction:</p>
<pre><code>{
  &quot;$class&quot;: &quot;org.acme.trading.Trade&quot;,
  &quot;commodity&quot;: &quot;resource:org.acme.trading.Commodity#ABC&quot;,
  &quot;newOwner&quot;: &quot;resource:org.acme.trading.Trader#TRADER2&quot;
}
</code></pre>
<p>After submitting this transaction, you should now see the transaction in the transaction registry. As a result, the owner of the commodity <code>ABC</code> should now be owned <code>TRADER2</code> in the Asset Registry.</p>
<p>Congratulations!</p>
<h1 id="summaries">Summaries</h1>
<h2 id="asset-definition">Asset Definition</h2>
<table>
<thead>
<tr>
<th>Namespace</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>org.hyperledger.composer.system.Asset</td>
<td>Asset</td>
<td>An asset named Asset</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.Registry</td>
<td>Registry</td>
<td>An asset named Registry</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.AssetRegistry</td>
<td>AssetRegistry</td>
<td>An asset named AssetRegistry</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.ParticipantRegistry</td>
<td>ParticipantRegistry</td>
<td>An asset named ParticipantRegistry</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.TransactionRegistry</td>
<td>TransactionRegistry</td>
<td>An asset named TransactionRegistry</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.Network</td>
<td>Network</td>
<td>An asset named Network</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.HistorianRecord</td>
<td>HistorianRecord</td>
<td>An asset named HistorianRecord</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.Identity</td>
<td>Identity</td>
<td>An asset named Identity</td>
</tr>
<tr>
<td>org.acme.trading.Commodity</td>
<td>Commodity</td>
<td>An asset named Commodity</td>
</tr>
</tbody>
</table>
<h2 id="transaction-definition">Transaction Definition</h2>
<table>
<thead>
<tr>
<th>Namespace</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>org.hyperledger.composer.system.Transaction</td>
<td>Transaction</td>
<td>A transaction named Transaction</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.RegistryTransaction</td>
<td>RegistryTransaction</td>
<td>A transaction named RegistryTransaction</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.AssetTransaction</td>
<td>AssetTransaction</td>
<td>A transaction named AssetTransaction</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.ParticipantTransaction</td>
<td>ParticipantTransaction</td>
<td>A transaction named ParticipantTransaction</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.AddAsset</td>
<td>AddAsset</td>
<td>A transaction named AddAsset</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.UpdateAsset</td>
<td>UpdateAsset</td>
<td>A transaction named UpdateAsset</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.RemoveAsset</td>
<td>RemoveAsset</td>
<td>A transaction named RemoveAsset</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.AddParticipant</td>
<td>AddParticipant</td>
<td>A transaction named AddParticipant</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.UpdateParticipant</td>
<td>UpdateParticipant</td>
<td>A transaction named UpdateParticipant</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.RemoveParticipant</td>
<td>RemoveParticipant</td>
<td>A transaction named RemoveParticipant</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.IssueIdentity</td>
<td>IssueIdentity</td>
<td>A transaction named IssueIdentity</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.BindIdentity</td>
<td>BindIdentity</td>
<td>A transaction named BindIdentity</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.ActivateCurrentIdentity</td>
<td>ActivateCurrentIdentity</td>
<td>A transaction named ActivateCurrentIdentity</td>
</tr>
<tr>
<td>org.hyperledger.composer.system.RevokeIdentity</td>
<td>RevokeIdentity</td>
<td>A transaction named RevokeIdentity</td>
</tr>
<tr>
<td>org.acme.trading.Trade</td>
<td>Trade</td>
<td>A transaction named Trade</td>
</tr>
<tr>
<td>org.acme.trading.TraderById</td>
<td>TraderById</td>
<td>A transaction named TraderById</td>
</tr>
<tr>
<td>org.acme.trading.BulkTrade</td>
<td>BulkTrade</td>
<td>A transaction named BulkTrade</td>
</tr>
<tr>
<td>org.acme.trading.RemoveHighQuantityCommodities</td>
<td>RemoveHighQuantityCommodities</td>
<td>A transaction named RemoveHighQuantityCommodities</td>
</tr>
<tr>
<td>org.acme.trading._demoSetup</td>
<td>_demoSetup</td>
<td>A transaction named _demoSetup</td>
</tr>
</tbody>
</table>
<h2 id="participant-definition">Participant Definition</h2>
<table>
<thead>
<tr>
<th>Namespace</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>org.hyperledger.composer.system.Participant</td>
<td>Participant</td>
<td>An participant named Participant</td>
</tr>
<tr>
<td>org.acme.trading.Trader</td>
<td>Trader</td>
<td>An participant named Trader</td>
</tr>
<tr>
<td>org.acme.trading.Regulator</td>
<td>Regulator</td>
<td>An participant named Regulator</td>
</tr>
</tbody>
</table>
<h2 id="acl">ACL</h2>
<h1 id="detail">Detail</h1>
<h3 id="transaction-functions">Transaction Functions</h3>
<p><em>Identifier</em> lib/logic.js
<em>Functions</em></p>
<h4 id="tradecommodity">tradeCommodity</h4>
<pre><code class="language-javascript">function tradeCommodity(trade) {

    // set the new owner of the commodity
    trade.commodity.owner = trade.newOwner;
    return getAssetRegistry('org.acme.trading.Commodity')
        .then(function (assetRegistry) {

            // emit a notification that a trade has occurred
            var tradeNotification = getFactory().newEvent('org.acme.trading', 'TradeNotification');
            tradeNotification.commodity = trade.commodity;
            emit(tradeNotification);

            // persist the state of the commodity
            return assetRegistry.update(trade.commodity);
        });
}
</code></pre>
<p><img src="tradeCommodity.svg" alt="tradeCommodity"></p>
<h4 id="tradebyid">TradeById</h4>
<pre><code class="language-javascript">function TradeById(tradeById){
    var commodityRegistry;
    return getAssetRegistry('org.acme.trading.Commodity')
    .then(function(registry){
        commodityRegistry=registry;
        return commodityRegistry.get(tradeById.tradingSymbol);
    })
    .then(function(result){
        result.quantity-=tradeById.qty;
        return commodityRegistry.update(result);
    });

}
</code></pre>
<p><img src="TradeById.svg" alt="TradeById"></p>
<h4 id="removehighquantitycommodities">removeHighQuantityCommodities</h4>
<pre><code class="language-javascript">function removeHighQuantityCommodities(remove) {

    return getAssetRegistry('org.acme.trading.Commodity')
        .then(function (assetRegistry) {
            return query('selectCommoditiesWithHighQuantity')
                    .then(function (results) {

                        var promises = [];

                        for (var n = 0; n &lt; results.length; n++) {
                            var trade = results[n];

                            // emit a notification that a trade was removed
                            var removeNotification = getFactory().newEvent('org.acme.trading', 'RemoveNotification');
                            removeNotification.commodity = trade;
                            emit(removeNotification);

                            // remove the commodity
                            promises.push(assetRegistry.remove(trade));
                        }

                        // we have to return all the promises
                        return Promise.all(promises);
                    });
        });
}
</code></pre>
<p><img src="removeHighQuantityCommodities.svg" alt="removeHighQuantityCommodities"></p>
<h4 id="setup">setup</h4>
<pre><code class="language-javascript">function setup(){
    var factory = getFactory();
 	var NS = 'org.acme.trading';
    var traders = [
      factory.newResource(NS,'Trader','CAROLINE'),
      factory.newResource(NS,'Trader','TRACY'),
      factory.newResource(NS,'Trader','TOM'),
      factory.newResource(NS,'Trader','WHOLESALER')
    ];
    
                          
    var commodities = [
      factory.newResource(NS,'Commodity','Ag'),
      factory.newResource(NS,'Commodity','Pb'),
      factory.newResource(NS,'Commodity','Fe'),
      factory.newResource(NS,'Commodity','Cu')
      ];
 
    /* add the resource and the traders */
    return getParticipantRegistry(NS+'.Trader')
  .then(function(traderRegistry){
            traders.forEach(function(trader) {
         
          trader.firstName = trader.getIdentifier().toLowerCase();
          trader.lastName = 'Trader';
      });
      return traderRegistry.addAll(traders);
    })
  .then(function(){
    	return getAssetRegistry(NS+'.Commodity');
    })
  .then(function(assetRegistry){
      var qty=5;
      commodities.forEach(function(commodity) {
        commodity.description='A lot of '+commodity.getIdentifier();
        commodity.mainExchange='Hursley';
        commodity.quantity = (qty);
        commodity.owner = factory.newRelationship(NS,'Trader','WHOLESALER');
        qty+=10;
      })
      return assetRegistry.addAll(commodities);
    });
  
}
</code></pre>
<p><img src="setup.svg" alt="setup"></p>
<h3 id="asset-model">Asset Model</h3>
<h4 id="asset">Asset</h4>
<p><strong>org.hyperledger.composer.system.Asset</strong> - <strong>An asset named Asset</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody></tbody>
</table>
<h4 id="registry">Registry</h4>
<p><strong>org.hyperledger.composer.system.Registry</strong> - <strong>An asset named Registry</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>registryId</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="assetregistry">AssetRegistry</h4>
<p><strong>org.hyperledger.composer.system.AssetRegistry</strong> - <strong>An asset named AssetRegistry</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>registryId</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="participantregistry">ParticipantRegistry</h4>
<p><strong>org.hyperledger.composer.system.ParticipantRegistry</strong> - <strong>An asset named ParticipantRegistry</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>registryId</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="transactionregistry">TransactionRegistry</h4>
<p><strong>org.hyperledger.composer.system.TransactionRegistry</strong> - <strong>An asset named TransactionRegistry</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>registryId</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>system</td>
<td>boolean</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="network">Network</h4>
<p><strong>org.hyperledger.composer.system.Network</strong> - <strong>An asset named Network</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>networkId</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
</tbody>
</table>
<h4 id="historianrecord">HistorianRecord</h4>
<p><strong>org.hyperledger.composer.system.HistorianRecord</strong> - <strong>An asset named HistorianRecord</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>transactionId</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
<tr>
<td>transactionType</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>transactionInvoked</td>
<td>string</td>
<td>The identifier of an instance of org.hyperledger.composer.system.Transaction</td>
</tr>
<tr>
<td>participantInvoking</td>
<td>string</td>
<td>The identifier of an instance of org.hyperledger.composer.system.Participant</td>
</tr>
<tr>
<td>identityUsed</td>
<td>string</td>
<td>The identifier of an instance of org.hyperledger.composer.system.Identity</td>
</tr>
<tr>
<td>eventsEmitted</td>
<td>array</td>
<td></td>
</tr>
<tr>
<td>transactionTimestamp</td>
<td>string</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="identity">Identity</h4>
<p><strong>org.hyperledger.composer.system.Identity</strong> - <strong>An asset named Identity</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>identityId</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>issuer</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>certificate</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>state</td>
<td>enum</td>
<td></td>
</tr>
<tr>
<td>participant</td>
<td>string</td>
<td>The identifier of an instance of org.hyperledger.composer.system.Participant</td>
</tr>
</tbody>
</table>
<h4 id="commodity">Commodity</h4>
<p><strong>org.acme.trading.Commodity</strong> - <strong>An asset named Commodity</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tradingSymbol</td>
<td>string</td>
<td>The instance identifier for this type</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>mainExchange</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>quantity</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td>owner</td>
<td>string</td>
<td>The identifier of an instance of org.acme.trading.Trader</td>
</tr>
</tbody>
</table>
<h3 id="acls">ACLs</h3>
<h3 id="queries">Queries</h3>
<p>still to do</p>
 
                    </section>
                </div>
                <!-- Otherwise, have the main content fill all 12 columns... -->

                <div class="PageNavigation">


                </div>
            </article>
        </div>





    </div>
    <script src="./assets/js/nav.js"></script>
</body>

</html>





